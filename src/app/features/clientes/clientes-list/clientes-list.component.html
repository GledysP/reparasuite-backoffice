<div class="rs-main-container"> 
  <div class="rs-header-row">
    <h1 class="rs-page-title">Clientes</h1>
  </div>

  <mat-card class="rs-filter-card">
    <mat-card-content>
      <form [formGroup]="form">
        <div class="rs-field">
          <div class="rs-field-label">Buscar por nombre, teléfono o email</div>
          
          <mat-form-field appearance="outline" class="rs-search-field">
            <mat-icon matPrefix>search</mat-icon>
            <input matInput formControlName="query" placeholder="Ej: Juan Pérez..." />
          </mat-form-field>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <mat-card class="rs-table-card">
    <mat-card-content class="no-padding">
      <div class="rs-table-responsive">
        <table mat-table [dataSource]="items" class="rs-table">
          
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef> Clientes </th>
            <td mat-cell *matCellDef="let row" class="fw-bold"> {{ row.nombre }} </td>
          </ng-container>

          <ng-container matColumnDef="telefono">
            <th mat-header-cell *matHeaderCellDef> Telefono </th>
            <td mat-cell *matCellDef="let row"> {{ row.telefono || '—' }} </td>
          </ng-container>

          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef> Correo electronico </th>
            <td mat-cell *matCellDef="let row" class="text-muted"> {{ row.email || '—' }} </td>
          </ng-container>

          <ng-container matColumnDef="totalWos">
            <th mat-header-cell *matHeaderCellDef class="cell-center"> Total OT </th>
            <td mat-cell *matCellDef="let row" class="cell-center"> {{ row.totalWos ?? 0 }} </td>
          </ng-container>

          <ng-container matColumnDef="lastWoDate">
            <th mat-header-cell *matHeaderCellDef class="cell-center"> Fecha ultima OT </th>
            <td mat-cell *matCellDef="let row" class="cell-center"> {{ (row.lastWoDate | date:'yyyy-MM-dd') || '—' }} </td>
          </ng-container>

          <ng-container matColumnDef="accion">
            <th mat-header-cell *matHeaderCellDef class="cell-right"> Acción </th>
            <td mat-cell *matCellDef="let row" class="cell-right">
              <div class="rs-actions-container">
                <button mat-icon-button [routerLink]="['/clientes', row.id]" class="rs-btn-action">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button (click)="eliminar(row)" class="rs-btn-action del-btn">
                  <mat-icon>delete_outline</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="rs-table-row"></tr>
        </table>
      </div>

      <mat-paginator
        class="rs-paginator"
        [length]="total"
        [pageIndex]="page"
        [pageSize]="size"
        [pageSizeOptions]="[10, 20, 50]"
        (page)="paginar($event)">
      </mat-paginator>
    </mat-card-content>
  </mat-card>
</div>